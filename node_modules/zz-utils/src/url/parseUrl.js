"use strict";

function parseUrl(url) {
    var reg = /(\w+):\/\/([\w\.]+)([\/\w]*)\??([\w_&=]*)#?(\w*)/;
    var result = url.match(reg);
    if (result) {
        var search = result[4];
        var query;

        if (search) {
            var json = "{\"" + search.replace(/&/g, "\",\"").replace(/=/g, "\":\"") + "\"}";
            query = JSON.parse(json);
        } else {
            query = {};
        }

        return { 
            protocol: result[1], 
            host: result[2], 
            pathname: result[3], 
            query: query, 
            hash: result[5]
        };
    }
}

module.exports = parseUrl;