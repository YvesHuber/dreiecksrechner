"use strict";
var setCtx = require("./setCtx");

function apply(ctx, fn) {
    ctx = setCtx.bind(this)(ctx);

    if (typeof fn === "function") {
        var args = [].slice.call(arguments, 2);
        var cb = null;

        if (typeof args[args.length - 1] === "function") {
            cb = args.pop();
        }
        var result = fn.apply(ctx, args);

        if (result !== null && cb !== null){
            cb(result, this);
        }
    } else {
        throw TypeError("fn must be type of Funtion");
    }
    return this;
}

module.exports = apply;